version: 2.1

#orbs:
#  win: circleci/windows@1.0.0

commands:
  test_command:
    parameters:
      gcc_version:
        type: integer
        default: 8
    steps:
      - run:
          name: "Test command"
          command: |
            echo "Test command"
            echo "gcc version 0: $(gcc -v)"
            echo ""
            echo "gcc version 02: $(g++ -v)"
            echo "Param: g++-<< parameters.gcc_version >>"
            sudo add-apt-repository ppa:ubuntu-toolchain-r/test
            sudo apt update
            sudo apt install -y uuid-dev libx11-dev openjdk-8-jdk g++-<< parameters.gcc_version >>
            sudo apt remove g++-5 gcc-5
            sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-<< parameters.gcc_version >> 100 --slave /usr/bin/g++ g++ /usr/bin/g++-<< parameters.gcc_version >>
            echo "gcc version 1: $(gcc -v)"
            echo ""
            echo "gcc version 2: $(g++ -v)"
          shell: /bin/bash

jobs:
  test_1:
    machine:
      image: ubuntu-1604:201903-01
    steps:
      - run:
          name: "Test job"
          command: |
            echo "Call test_command"
          shell: /bin/bash
      - test_command:
          gcc_version: 9

workflows:
  version: 2
  test_workspace:
    jobs:
      - test_1
